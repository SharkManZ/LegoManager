<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings version="2.0" xmlns="http://java.sun.com/xml/ns/persistence/orm"
                 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm
        http://java.sun.com/xml/ns/persistence/orm_2_0.xsd ">
    <!-- Детали набора -->
    <named-query name="getSetPartsBySetId">
        <query>select sp from SetPartEntity sp
            join sp.partColor pc
            join pc.part p
            join pc.color c
            where sp.set.id = :setId and
            (lower(pc.number) like '%' || lower(:search) || '%' or
            lower(pc.alternateNumber) like '%' || lower(:search) || '%' or
            lower(p.number) like '%' || lower(:search) || '%' or
            lower(p.alternateNumber) like '%' || lower(:search) || '%' or
            lower(p.name) like '%' || lower(:search) || '%' or
            lower(c.name) like '%' || lower(:search) || '%'
            )
            order by sp.id desc
        </query>
    </named-query>
    <named-query name="getSetPartBySetAndPrtColorId">
        <query>select sp from SetPartEntity sp where sp.set.id = :setId and sp.partColor.id = :partColorId</query>
    </named-query>
    <named-query name="getSetPartsCount">
        <query>select sum(s.count) from SetPartEntity s</query>
    </named-query>
</entity-mappings>